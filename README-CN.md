# tMath - é«˜åº¦ç±»å‹è§£è€¦ã€æ³›å‹åŒ– C++ æ•°å­¦åº“
[English](README.md)

tMath æ˜¯ä¸€ä¸ªheader-onlyï¼ŒåŸºäº C++20 Concepts çš„é«˜åº¦æ³›å‹åŒ–æ•°å­¦åº“ï¼Œä¸“æ³¨äºç±»å‹è§£è€¦ï¼ˆTemplate-based Decouplingï¼‰å’Œé«˜æ€§èƒ½è¿ç®—ï¼ˆSIMD-readyï¼‰ã€‚

å®ƒå…è®¸å¼€å‘è€…ä½¿ç”¨ä»»ä½•ç¬¦åˆç‰¹å®šå†…å­˜å¸ƒå±€çš„ç»“æ„ä½“ï¼ˆä¾‹å¦‚ struct { float x, y; }ï¼‰è¿›è¡Œå‘é‡è¿ç®—ï¼Œæ— éœ€ç»§æ‰¿åº“å†…åŸºç±»ï¼Œå®ç°äº†é›¶ä¾µå…¥æ€§çš„æŠ½è±¡ã€‚

## âœ¨æ ¸å¿ƒäº®ç‚¹

| **ç‰¹æ€§**         | **æè¿°**                                                                      |
| -------------- |-----------------------------------------------------------------------------|
| âœ¨**ç±»å‹é›¶ä¾µå…¥æ€§**    | å¼€å‘è€…å¯ä»¥è‡ªå¸¦æ•°æ®ç±»å‹ã€‚æ‚¨çš„è‡ªå®šä¹‰ç»“æ„ä½“ï¼ˆå¦‚ `Vector2f`ï¼‰å¯ç›´æ¥ç”¨äºæ‰€æœ‰ `tMath` å‡½æ•°ï¼Œæ— éœ€ç»§æ‰¿æˆ–å°è£…ï¼Œå®ç°äº†ç±»å‹ä¸åŠŸèƒ½çš„å®Œå…¨åˆ†ç¦»ã€‚ |
| âœ¨**SIMD ä¼˜åŒ–å°±ç»ª** | æä¾›SIMDå‡½æ•°å’ŒSIMDä¸“ç”¨conceptï¼Œè®©æ•°å­¦è¿ç®—çš„æ€§èƒ½å¤§å¹…æå‡ã€‚                                        |
| **å®‰å…¨çš„æ•´æ•°è¿ç®—**    | æ™ºèƒ½å¤„ç†æ•´æ•°çš„å‘é‡è®¡ç®—ã€‚é€šè¿‡è‡ªåŠ¨ç±»å‹æå‡ï¼ˆå¦‚ `int32_t` æå‡åˆ° `double`ï¼‰æ¥æ¶ˆé™¤è®¡ç®—ä¸­çš„æº¢å‡ºé£é™©å’Œç²¾åº¦é—®é¢˜ã€‚             |
| **Quat é›¶å¼€é”€åŒºåˆ†** | ä½¿ç”¨ **Tag Type** æœºåˆ¶åŒºåˆ†å†…å­˜å¸ƒå±€ç›¸åŒçš„ `Vector4` å’Œ `Quat`ï¼Œä¿è¯äº†æ•°å­¦è¿ç®—çš„æ­£ç¡®åˆ†æ´¾ï¼Œä¸”ä¸å¢åŠ ç»“æ„ä½“å¤§å°ã€‚      |



## ğŸ“ è®¾è®¡å“²å­¦ï¼šç±»å‹è§£è€¦

tMath çš„æ ¸å¿ƒç†å¿µæ˜¯è§£è€¦ã€‚å®ƒå°†æ•°æ®ç»“æ„çš„å®šä¹‰æƒå®Œå…¨äº¤ç»™äº†å¼€å‘è€…ï¼Œè€Œåº“åªè´Ÿè´£é€šè¿‡ Concepts æ£€æŸ¥ç»“æ„æ˜¯å¦ç¬¦åˆè¿ç®—è¦æ±‚ã€‚

### ç¤ºä¾‹1ï¼šè‡ªå®šä¹‰Vectorç±»å‹

```c++
// ç”¨æˆ·çš„è‡ªå®šä¹‰ç±»å‹
struct MyVector2
{
    float x;
    float y;
};

struct MyVec2 
{
    float x = 0, y = 0;
};

// ä¸€è¡Œä»£ç æ”¯æŒè‡ªå®šä¹‰ç±»å‹çš„è¿ç®—ç¬¦é‡è½½ (å¯ä»¥å…¨å±€å®šä¹‰ï¼Œä¹Ÿå¯ä»¥å®šä¹‰åœ¨å‡½æ•°ä½œç”¨åŸŸå†…)
TMATH_ENABLE_OPERATORS

// tMath è‡ªåŠ¨è¯†åˆ«å¹¶æä¾›æ‰€æœ‰è¿ç®—
MyVector2 p1 = { 1.5f, 2.5f };
MyVector2 p2 = { 3.5f, 2.5f };

// å‘é‡åŠ æ³• (operator+)
MyVector2 p3 = p1 + p2; // p3 = {5.0f, 5.0f}

// ç‚¹ç§¯è¿ç®— (dot)
float d = tMath::dot(p1, p2); // d = 1.5*3.5 + 2.5*2.5 = 11.5f


// è‡ªå®šä¹‰MyVec2ç±»å‹
MyVec2 vec = { 1000, 0 };
assert(tMath::approximately(tMath::normalized(vec), { 1, 0 }));
```

### ç¤ºä¾‹2ï¼šè¶…çº§è‡ªç”±çš„ç±»å‹è½¬æ¢ (tMath::precision_cast<T>(vec_or_mat))

```c++
// å¼€å‘è€…è‡ªå®šä¹‰ Vector2 ç±»å‹
struct Vector2f
{
    float x = 0, y = 0;
};

// å¼€å‘è€…è‡ªå®šä¹‰å¦ä¸€ä¸ª Vector2 ç±»å‹
struct Vector2i16
{
    int16_t x = 0, y = 0;
};

// ç±»å‹è½¬æ¢
Vector2f v2f = { 1.1, 2.2 };
Vector2i16 test = { 1, 2 };
assert(tMath::precision_cast<Vector2i16>(v2f) == test);
```

### ç¤ºä¾‹3ï¼šè‡ªåŠ¨ç²¾åº¦æå‡

```c++
using Vector2i32 = struct { int32_t x, y; };

Vector2i32 a = { 5, 10 };
Vector2i32 b = { 2, -5 };

// è¿”å›ç±»å‹ï¼šè‡ªåŠ¨æå‡åˆ° double
auto dis = tMath::distance(a, b); 
// dis çš„ç±»å‹æ˜¯ doubleï¼Œç»“æœä¸º 15.29705854077835449
```

## CMakeé›†æˆ
1. æ·»åŠ tMathä½œä¸ºsub_directory
```cmake
add_subdirectory(${your_project_path}/3rdparty/tMath)
```
2. é“¾æ¥ tMath åº“
```cmake
add_executable(my_project source.cpp)
target_link_libraries(my_project PRIVATE tMath)
```
